<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="dark">
    <meta name="description" content="Create stunning animated map visualizations with simple text commands">
    <title>Pillars of Creation Maps</title>
    
    <!-- Preload critical resources -->
    <link rel="preload" href="https://unpkg.com/maplibre-gl@4.7.1/dist/maplibre-gl.css" as="style">
    <link rel="preload" href="https://unpkg.com/maplibre-gl@4.7.1/dist/maplibre-gl.js" as="script">
    <link rel="prefetch" href="./data/countries.geojson">
    <link rel="prefetch" href="./data/regions.geojson">
    
    <!-- DNS prefetch -->
    <link rel="dns-prefetch" href="https://tiles.openfreemap.org">
    <link rel="dns-prefetch" href="https://gibs-a.earthdata.nasa.gov">
    
    <!-- Stylesheets -->
    <link href="https://unpkg.com/maplibre-gl@4.7.1/dist/maplibre-gl.css" rel="stylesheet" />
    <link href="./css/styles.css" rel="stylesheet" />
</head>

<body>
    <header>
        <div class="logo">ğŸŒŒ Pillars of Creation Maps</div>
        <div class="header-controls">
            <select id="styleSelect">
                <option value="liberty">Liberty</option>
                <option value="satellite">ğŸ›°ï¸ Satellite</option>
            </select>
            <label class="checkbox-label satellite-only" style="display:none">
                <input type="checkbox" id="showBorders"> Borders
            </label>
            <label class="checkbox-label satellite-only" style="display:none">
                <input type="checkbox" id="showLabels"> Labels
            </label>
            <button onclick="app.clearAll()">Clear Map</button>
            <button onclick="app.toggleFullscreen()">â›¶ Fullscreen</button>
            <button onclick="app.startVideoRecording()" id="recordBtn">âº Record</button>
            <button onclick="app.stopVideoRecording()" id="stopBtn" style="display:none">â¹ Stop & Save</button>
        </div>
    </header>

    <main>
        <aside class="sidebar">
            <div class="toolbar">
                <button onclick="app.insertCommand('wait: 1s')" title="Add delay">â±ï¸ Wait</button>
                <button onclick="app.insertCommand('fly: 50, 10, 4')" title="Fly to location">âœˆï¸ Fly</button>
                <button onclick="app.insertCommand('cinematic: 50, 10, 4, 45, 60')" title="Cinematic view">ğŸ¬ Cinematic</button>
                <button onclick="app.insertCommand('zoom: Germany')" title="Zoom to country">ğŸ” Zoom</button>
                <div class="toolbar-divider"></div>
                <button onclick="app.insertCommand('bubble: 50, 10, &quot;Text&quot;, blue')" title="Add text bubble">ğŸ’¬ Bubble</button>
                <button onclick="app.insertCommand('year: 50, 10, &quot;2024&quot;, highlight')" title="Add year badge">ğŸ“… Year</button>
                <button onclick="app.insertCommand('arrow: 50, 10, &quot;Label&quot;, right')" title="Add arrow label">â¡ï¸ Arrow</button>
                <div class="toolbar-divider"></div>
                <button onclick="app.insertCommand('remove: last')" title="Remove last label">ğŸ—‘ï¸</button>
            </div>

            <div class="tabs">
                <button class="tab active" data-tab="editor">Editor</button>
                <button class="tab" data-tab="examples">Examples</button>
                <button class="tab" data-tab="help">Help</button>
            </div>

            <div class="tab-content active" id="tab-editor">
                <textarea class="editor" id="editor" placeholder="# Right-click on map to add countries
# Use toolbar to insert commands

germany: blue, fade
france: green, radial

bubble: 52, 13, &quot;Berlin&quot;, blue
wait: 2s
cinematic: 52, 13, 6, 45, 60"></textarea>
            </div>

            <div class="tab-content" id="tab-examples">
                <div class="examples-list" id="examplesList"></div>
            </div>

            <div class="tab-content" id="tab-help">
                <div class="help-content">
                    <h3>ğŸ¨ Coloring Countries</h3>
                    <p><code>country: color, animation</code></p>
                    <p>Example: <code>germany: blue, radial</code></p>

                    <h3>ğŸ—ºï¸ Coloring Regions</h3>
                    <p><code>region: Name, Country, color, animation</code></p>
                    <p>Example: <code>region: Bavaria, Germany, orange, sweep</code></p>

                    <h3>ğŸ”— Draw Lines</h3>
                    <p><code>line: Country1, Country2, color</code></p>
                    <p>Example: <code>line: Germany, France, blue</code></p>

                    <h3>ğŸ’¬ Text Bubble</h3>
                    <p><code>bubble: lat, lng, "text", color</code></p>

                    <h3>ğŸ“… Year Badge</h3>
                    <p><code>year: lat, lng, "2024", highlight</code></p>

                    <h3>â¡ï¸ Arrow Label</h3>
                    <p><code>arrow: lat, lng, "text", direction, color</code></p>

                    <h3>ğŸ¬ Camera</h3>
                    <p><code>fly: lat, lng, zoom</code></p>
                    <p><code>cinematic: lat, lng, zoom, pitch, bearing</code></p>

                    <h3>â±ï¸ Controls</h3>
                    <p><code>wait: 2s</code> - pause</p>
                    <p><code>zoom: Germany</code> - auto-fit</p>
                    <p><code>remove: last</code> - remove label</p>

                    <h3>ğŸ’¡ Tips</h3>
                    <p>â€¢ Right-click for context menu</p>
                    <p>â€¢ Animations: fade, radial, sweep</p>
                    <p>â€¢ Labels scale with zoom</p>
                </div>
            </div>

            <button class="run-btn primary" onclick="app.run()">â–¶ Run Animation</button>
        </aside>

        <div class="map-container">
            <div id="map"></div>
            <div class="map-status" id="status">Loading...</div>
            <div class="map-attribution">
                <a href="https://openfreemap.org" target="_blank">OpenFreeMap</a> Â·
                <a href="https://naturalearthdata.com" target="_blank">Natural Earth</a>
            </div>
        </div>
    </main>

    <!-- Context Menu -->
    <div class="context-menu" id="contextMenu">
        <div class="context-menu-header" id="menuTitle">Select</div>
        <div class="context-menu-section">Choose color</div>
        <div class="color-palette" id="colorPalette"></div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" data-action="addCountry">
            <span class="icon">ğŸ¨</span> Color this country
        </div>
        <div class="context-menu-item" data-action="addRegion">
            <span class="icon">ğŸ—ºï¸</span> Color this region
        </div>
        <div class="context-menu-item" data-action="addLine">
            <span class="icon">ğŸ”—</span> Draw line from here
        </div>
        <div class="context-menu-item" data-action="addBubble">
            <span class="icon">ğŸ’¬</span> Add text bubble
        </div>
        <div class="context-menu-item" data-action="addCinematic">
            <span class="icon">ğŸ¬</span> Cinematic camera
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" data-action="close">
            <span class="icon">âœ•</span> Cancel
        </div>
    </div>

    <!-- MapLibre -->
    <script src="https://unpkg.com/maplibre-gl@4.7.1/dist/maplibre-gl.js"></script>

    <!-- App modules (order matters!) -->
    <script src="./js/config.js"></script>
    <script src="./js/geodata.js"></script>
    <script src="./js/renderer.js"></script>
    <script src="./js/labels.js"></script>
    <script src="./js/parser.js"></script>
    <script src="./js/executor.js"></script>
    <script src="./js/editor.js"></script>
    <script src="./js/context-menu.js"></script>
    <script src="./js/app.js"></script>
    <script src="./js/main.js"></script>
</body>

</html>